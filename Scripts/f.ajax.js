(function(F){var Ajax=F.ajax=window.Ajax=function(opt){opt=Ajax.fn.Ajax_Extend(Ajax.Setting,opt?opt:{});if(opt.form&&(opt.form.nodeName.toLowerCase()=="form")){Ajax.fn.postf(opt)}else{Ajax.fn.Do(opt)}};Ajax.Setting={asc:true,url:"",dataType:"text",method:"GET",data:"",form:null,timeout:10000,isTimeout:false,charset:"utf-8",username:"",userpwd:"",succeed:function(a,b,c){return true},error:function(a,b,c){return true},ontimeout:function(a){return true},beforesend:function(a){return true}};Ajax.response=function(a,s){if(a.readyState==4){if(a.status==200){var t=s.dataType.toLowerCase();if(t=="text"){s.succeed.apply(this,[a.responseText,a])}if(t=="textp"){s.succeed.apply(this,[a.responseText,a]);var __regexp=/<script(.*?)>([\s\S]*?)<\/script>/igm;var __jotemp=__regexp.exec(a.responseText);while(__jotemp){eval(__jotemp[2]);__jotemp=__regexp.exec(a.responseText)}}if(t=="xml"){try{try{var Dom=new ActiveXObject("MSXML2.DomDocument")}catch(ex){var Dom=document.implementation.createDocument("","",null)}Dom.loadXML(a.responseText);s.succeed.apply(this,[Dom,a])}catch(ex){s.succeed.apply(this,[null,a])}}if(t=="json"){var j=null;try{eval("j = ("+a.responseText+");")}catch(ex){j=null}s.succeed.apply(this,[j,a])}if(t=="jsonp"){eval(s.jsonp+"("+a.responseText+");")}a=null}else{s.error.apply(this,[a.status,a]);a=null}}};Ajax.fn=Ajax.prototype={Do:function(options){var settings=options;var isTimeout=false;var s=settings;s.method=s.method.toUpperCase();s.charset=s.charset.toLowerCase();try{var a=Ajax.fn.Ajax_GetObj();var u=s.url;var b=u.indexOf("?")==-1;var d=null,_d="";u=u+(b?"?":"&")+"aienrnd="+Ajax.fn.Ajax_Rnd();if(typeof s.data=="object"){_d=Ajax.SerializJson(s.data)}else{_d=s.data}if(s.method=="GET"){u=_d==""?u:(u+"&"+_d)}if(s.method=="POST"){d=_d}s.beforesend.apply(s,[a]);if(s.username&&s.username!=""){a.open(s.method,u,s.asc,s.username,s.userpwd)}else{a.open(s.method,u,s.asc)}if(s.method=="POST"){a.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}if(s.asc){a.onreadystatechange=function(){if(s.isTimeout&&s.readyState<=3){s.ontimeout.apply(s,[a]);a.abort();a=null;return}Ajax.response.apply(s,[a,s])}}a.send(d);if(s.asc){window.setTimeout(function(){s.isTimeout=true},s.timeout);return}Ajax.response.apply(s,[a,s])}catch(ex){s.error.apply(s,[ex.description,null,s])}},Ajax_GetObj:function(){var b=null;if(window.XMLHttpRequest){b=new XMLHttpRequest();Ajax.fn.Ajax_GetObj=function(){return new XMLHttpRequest()}}else{if(window.ActiveXObject){var httplist=["MSXML2.XMLHttp.3.0","MSXML2.XMLHttp","Microsoft.XMLHttp","MSXML2.XMLHttp.5.0","MSXML2.XMLHttp.4.0"];for(var i=httplist.length-1;i>=0;i--){try{Ajax.fn.Ajax_GetObj=(function(obj){return function(){return new ActiveXObject(obj)}})(httplist[i]);b=Ajax.fn.Ajax_GetObj()}catch(ex){}}}}return b},Ajax_Rnd:function(){return Math.random().toString().substr(2)},Ajax_Extend:function(a,b){var c={};for(var m in a){c[m]=a[m]}for(var m in b){c[m]=b[m]}return c}};Ajax.get=Ajax.fn.get=function(url,data,fn){var setting={};setting.url=url;setting.data=data;setting.succeed=fn;Ajax(setting)};Ajax.post=Ajax.fn.post=function(url,data,fn){var setting={};setting.url=url;setting.data=data;setting.succeed=fn;setting.method="post";Ajax(setting)};Ajax.SerializJson=Ajax.fn.SerializJson=function(json){if(typeof json!="object"){return""}var _temp="";for(var i in json){_temp+=Ajax.encode.utf8(""+i+"")+"="+Ajax.encode.utf8(""+json[i]+"")+"&"}if(_temp!=""){_temp=_temp.substr(0,_temp.length-1)}return _temp};Ajax.Serializ=Ajax.fn.Serializ=function(nodes,charset){charset=charset.toLowerCase();var data="";for(var i=0;i<nodes.length;i++){if(!nodes[i].name||(Ajax.encode.trim(nodes[i].name)=="")){continue}var node_name=Ajax.encode.trim(nodes[i].name);var node_value=nodes[i].value;var isBox=(nodes[i].type.toLowerCase()=="checkbox")||(nodes[i].type.toLowerCase()=="radio");if(isBox){if(nodes[i].checked==true){if(charset=="utf-8"){data+=Ajax.encode.utf8(node_name)+"="+(node_value==""?"on":Ajax.encode.utf8(node_value))+"&"}else{data+=Ajax.encode.gb(node_name)+"="+(node_value==""?"on":Ajax.encode.gb(node_value))+"&"}}}else{if(charset=="utf-8"){data+=Ajax.encode.utf8(node_name)+"="+Ajax.encode.utf8(node_value)+"&"}else{data+=Ajax.encode.gb(node_name)+"="+Ajax.encode.gb(node_value)+"&"}}}return data};Ajax.postf=Ajax.fn.postf=function(setting){setting=Ajax.fn.Ajax_Extend(Ajax.Setting,setting);frm=setting.form;if(frm.nodeName.toLowerCase()!="form"||frm.action==""){return false}setting.method="POST";if(frm.method.toLowerCase()!="post"){setting.method="GET"}setting.url=frm.action;var data="";data=Ajax.Serializ(frm,setting.charset);if(data!=""){data=data.substr(0,data.length-1)}setting.data=data;Ajax.fn.Do(setting);return false};Ajax.encode={gb:function(str){return escape(str||"")},utf8:function(str){return encodeURIComponent(str||"").replace(/\+/,"%2B").replace(/\%([0-9a-zA-Z]{2})/ig,function(s){return s.toLowerCase()})},unUtf8:function(str){return decodeURIComponent(str||"")},trim:function(str){return(str||"").replace(/^(\s+)|(\s+)$/igm,"")}}})(F||{});